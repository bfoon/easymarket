{% extends 'base.html' %}
{% block content %}
{% load custom_filters %}

{% load static %}

<link rel="stylesheet" type="text/css" href="{% static 'css/main.css' %}">
<!-- Hero Section -->
<section class="hero-section text-white py-5" style="background: linear-gradient(135deg, #2563eb, #f59e0b);">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-8">
                <h1 class="display-4 fw-bold mb-3">Discover Amazing Products</h1>
                <p class="lead mb-4">Find everything you need at unbeatable prices. Quality products with fast delivery.</p>
                <div class="d-flex flex-wrap gap-3">
                    <div class="d-flex align-items-center text-white-50">
                        <i class="fas fa-truck me-2"></i>
                        <span>Cheapest Shipping</span>
                    </div>
                    <div class="d-flex align-items-center text-white-50">
                        <i class="fas fa-shield-alt me-2"></i>
                        <span>Secure Payment</span>
                    </div>
                    <div class="d-flex align-items-center text-white-50">
                        <i class="fas fa-undo me-2"></i>
                        <span>Easy Returns</span>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 text-center">
                <i class="fas fa-shopping-bag" style="font-size: 8rem; opacity: 0.3;"></i>
            </div>
        </div>
    </div>
</section>

<!-- Trending Products Carousel -->
<section class="py-5 bg-light">
    <div class="container">
        <div class="text-center mb-4">
            <h2 class="fw-bold" style="font-size: 1.5rem;">Trending Products</h2>
            <p class="text-muted" style="font-size: 0.9rem;">Top picks loved by our shoppers</p>
        </div>

        <div id="trendingCarousel" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-inner">

                {% for chunk in trending_products|slice:"0:12"|make_chunks:4 %}
                <div class="carousel-item {% if forloop.first %}active{% endif %}">
                    <div class="d-flex justify-content-center gap-4">
                        {% for product in chunk %}
                        <div class="text-center">
                            <a href="{% url 'marketplace:product_detail' product.id %}" class="d-inline-block">
                                <img src="{{ product.image.url }}" class="img-fluid" alt="{{ product.name }}" style="height: 100px; width: 100px; object-fit: cover; border-radius: 8px;">
                            </a>
                            <div class="mt-2" style="font-size: 0.8rem;">{{ product.name }}</div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endfor %}

            </div>

            <button class="carousel-control-prev" type="button" data-bs-target="#trendingCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon bg-dark rounded-circle" aria-hidden="true"></span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#trendingCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon bg-dark rounded-circle" aria-hidden="true"></span>
            </button>
        </div>
    </div>
</section>

<!-- Categories Section -->
<section id="categories" class="py-5">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-5 fw-bold">Shop by Category</h2>
            <p class="lead text-muted">Find exactly what you're looking for</p>
        </div>

        <div class="row g-4">
            {% for category in categories %}
            <div class="col-lg-3 col-md-6">
                <div class="card category-card h-100 text-center p-4">
                    <div class="card-body">
                        {% if category.icon %}
                            <i class="{{ category.icon }} category-icon mb-3" style="font-size: 4rem; color: #2563eb;"></i>
                        {% endif %}
                        <h5 class="card-title">{{ category.name }}</h5>
                        <p class="card-text">{{ category.description|truncatewords:10 }}</p>
                        <a href="#" class="btn btn-outline-primary rounded-pill px-4">Explore</a>
                    </div>
                </div>
            </div>
            {% empty %}
            <p class="text-center">No categories available.</p>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Featured Products -->
<section id="products" class="py-5 bg-light">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-5 fw-bold">Featured Products</h2>
            <p class="lead text-muted">Handpicked deals just for you</p>
        </div>

        <div class="row g-4">
            {% for product in featured_products %}
           <div class="col-lg-3 col-md-6">
                    <div class="card product-card h-100">
                        <div class="position-relative">
                            <a href="{% url 'marketplace:product_detail' product.id %}">
                                <img src="{{ product.image.url }}" class="card-img-top product-image" alt="{{ product.name }}">
                            </a>
                            {% if product.discount %}
                                <span class="badge-sale">{{ product.discount }}% OFF</span>
                            {% endif %}
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">{{ product.name }}</h5>
                            <p class="card-text text-muted">{{ product.description|truncatewords:12 }}</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <span class="price-tag">${{ product.price }}</span>
                                    {% if product.original_price %}
                                        <span class="original-price ms-2">${{ product.original_price }}</span>
                                    {% endif %}
                                </div>
                                <div class="rating">
                                    <i class="fas fa-star text-warning"></i>
                                    <i class="fas fa-star text-warning"></i>
                                    <i class="fas fa-star text-warning"></i>
                                    <i class="fas fa-star text-warning"></i>
                                    <i class="fas fa-star-half-alt text-warning"></i>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer bg-transparent">
                            <button class="btn btn-primary w-100">Add to Cart</button>
                        </div>
                    </div>
                </div>
            {% empty %}
            <p class="text-center">No featured products available.</p>
            {% endfor %}
        </div>

        <div class="text-center mt-5">
            <a href="{% url 'marketplace:product_list' %}" class="btn btn-outline-primary btn-lg">View All Products</a>
        </div>
    </div>
</section>

<!-- Quick View Modal -->
<div class="modal fade" id="quickViewModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalProductName">Product Name</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <img id="modalProductImage" src="" alt="" class="img-fluid rounded">
                    </div>
                    <div class="col-md-6">
                        <p id="modalProductDescription" class="mb-3"></p>
                        <h4 id="modalProductPrice" class="text-success mb-4"></h4>
                        <div class="d-grid gap-2">
                            <button class="btn btn-primary btn-lg" onclick="addToCart()">
                                <i class="fas fa-cart-plus me-2"></i>Add to Cart
                            </button>
                            <button class="btn btn-outline-secondary">
                                <i class="far fa-heart me-2"></i>Add to Wishlist
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Success Toast -->
<div class="toast-container position-fixed bottom-0 end-0 p-3">
    <div id="successToast" class="toast" role="alert">
        <div class="toast-header bg-success text-white">
            <i class="fas fa-check-circle me-2"></i>
            <strong class="me-auto">Success</strong>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast"></button>
        </div>
        <div class="toast-body" id="toastMessage">
            Product added to cart successfully!
        </div>
    </div>
</div>

<script src="{% static 'js/main.js' %}">
</script>

{% endblock %}